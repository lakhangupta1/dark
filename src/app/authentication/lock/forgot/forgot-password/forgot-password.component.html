<div class="container mt-5">

  <!-- Forgot Password Form -->
  @if (!submitted) {
    <div class="row justify-content-center">
      <div class="col-md-6">
        <div class="card custom-card">
          <div class="card-body">
            <h4 class="card-title text-center">Forgot Password</h4>

            <form #forgotPasswordForm="ngForm" (ngSubmit)="onSubmit(forgotPasswordForm)">
              <!-- Email Field -->
              <div class="mb-3">
                <label for="email" class="form-label">Enter your Email:</label>
                <input 
                  type="email" 
                  id="email" 
                  name="email" 
                  class="form-control" 
                  [(ngModel)]="user.email" 
                  #emailInput="ngModel"
                  required 
                  [ngClass]="{'is-invalid': emailInput.invalid && (emailInput.dirty || emailInput.touched)}"
                />

                @if (emailInput.invalid && (emailInput.dirty || emailInput.touched)) {
                  <div class="invalid-feedback d-block">
                    @if (emailInput.errors?.['required']) {
                      <div>Email is required.</div>
                    }
                    @if (emailInput.errors?.['email']) {
                      <div>Please enter a valid email address.</div>
                    }
                  </div>
                }
              </div>

              <!-- Submit -->
              <div class="d-grid gap-2">
                <button 
                  type="submit" 
                  class="btn btn-primary" 
                  [disabled]="!forgotPasswordForm.valid">
                  Submit
                </button>
              </div>
            </form>

          </div>
        </div>
      </div>
    </div>
  }

  <!-- Create Password Form -->
  @if (submitted) {
    <div class="row justify-content-center">
      <div class="col-md-6">
        <div class="card custom-card">
          <div class="card-body">
            <h4 class="card-title text-center">Create Password</h4>

            <form #createPasswordForm="ngForm" (ngSubmit)="createPassword(createPasswordForm)">                

              <!-- Password Field -->
              <div class="mb-3 position-relative">
                <label for="password" class="form-label">Enter your password:</label>
                <input 
                  [type]="showPassword ? 'text' : 'password'" 
                  id="password" 
                  name="password" 
                  class="form-control" 
                  [(ngModel)]="user.password" 
                  #passwordInput="ngModel"
                  required 
                  [ngClass]="{'is-invalid': passwordInput.invalid && (passwordInput.dirty || passwordInput.touched)}"
                />

                <!-- Eye toggle button -->
                <span 
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                  style="cursor: pointer;"
                  (click)="showPassword = !showPassword">
                  <i class="bi" [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
                </span>

                @if (passwordInput.invalid && (passwordInput.dirty || passwordInput.touched)) {
                  <div class="invalid-feedback d-block">
                    @if (passwordInput.errors?.['required']) {
                      <div>Password is required.</div>
                    }
                  </div>
                }
              </div>

              <!-- Confirm Password Field -->
              <div class="mb-3 position-relative">
                <label for="confirmPassword" class="form-label">Enter your confirm password:</label>
                <input 
                  [type]="showConfirmPassword ? 'text' : 'password'" 
                  id="confirmPassword" 
                  name="confirmPassword" 
                  class="form-control" 
                  [(ngModel)]="user.confirmPassword" 
                  #confirmPassword="ngModel"
                  required 
                  [ngClass]="{'is-invalid': confirmPassword.invalid && (confirmPassword.dirty || confirmPassword.touched)}"
                />

                <!-- Eye toggle button -->
                <span 
                  class="position-absolute top-50 end-0 translate-middle-y me-3"
                  style="cursor: pointer;"
                  (click)="showConfirmPassword = !showConfirmPassword">
                  <i class="bi" [ngClass]="showConfirmPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
                </span>

                @if (confirmPassword.invalid && (confirmPassword.dirty || confirmPassword.touched)) {
                  <div class="invalid-feedback d-block">
                    @if (confirmPassword.errors?.['required']) {
                      <div>Confirm password is required.</div>
                    }
                  </div>
                }
              </div>

              <!-- Submit Button -->
              <div class="d-grid gap-2">
                <button 
                  type="submit" 
                  class="btn btn-primary" 
                  [disabled]="!createPasswordForm.valid">
                  Create
                </button>
              </div>

            </form>
          </div>
        </div>
      </div>
    </div>
  }

</div>
